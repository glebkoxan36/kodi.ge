<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ტელეფონების შედარება</title>
    <link rel="stylesheet" href="static/compare.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-mobile-alt"></i> ტელეფონების მახასიათებლების შედარება</h1>
            <p class="subtitle">აირჩიეთ ორი ტელეფონი მათი მახასიათებლების, პროდუქტიულობის და ფასის შესადარებლად</p>
        </header>
        
        <div class="search-section">
            <div class="search-box">
                <div class="search-header">
                    <span class="phone-number">1</span>
                    <h2>პირველი ტელეფონი</h2>
                </div>
                <div id="selected-phone1" class="selected-phone" style="display: none;">
                    <div class="selected-phone-info">
                        <img id="selected-phone1-img" src="" alt="ტელეფონი 1">
                        <span id="selected-phone1-name" class="selected-phone-name"></span>
                    </div>
                    <button class="clear-btn" id="phone1-clear">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <button class="select-btn" id="select-phone1-btn">
                    <i class="fas fa-search"></i> ტელეფონის არჩევა
                </button>
            </div>
            
            <div class="search-box">
                <div class="search-header">
                    <span class="phone-number phone-number-2">2</span>
                    <h2>მეორე ტელეფონი</h2>
                </div>
                <div id="selected-phone2" class="selected-phone" style="display: none;">
                    <div class="selected-phone-info">
                        <img id="selected-phone2-img" src="" alt="ტელეფონი 2">
                        <span id="selected-phone2-name" class="selected-phone-name"></span>
                    </div>
                    <button class="clear-btn" id="phone2-clear">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <button class="select-btn select-btn-2" id="select-phone2-btn">
                    <i class="fas fa-search"></i> ტელეფონის არჩევა
                </button>
            </div>
        </div>
        
        <button id="compare-phones" class="compare-btn" disabled>
            <i class="fas fa-exchange-alt"></i> ტელეფონების შედარება
        </button>
        
        <!-- Модальные окна для выбора телефонов -->
        <div id="phone1-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-mobile-alt"></i> აირჩიეთ პირველი ტელეფონი</h3>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="search-input-container">
                    <input type="text" id="phone1-modal-search" placeholder="შეიყვანეთ ბრენდი ან მოდელი..." autocomplete="off">
                    <button class="modal-clear-btn" id="phone1-modal-clear" style="display: none;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="search-results" id="phone1-modal-results"></div>
            </div>
        </div>
        
        <div id="phone2-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-mobile-alt"></i> აირჩიეთ მეორე ტელეფონი</h3>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="search-input-container">
                    <input type="text" id="phone2-modal-search" placeholder="შეიყვანეთ ბრენდი ან მოდელი..." autocomplete="off">
                    <button class="modal-clear-btn" id="phone2-modal-clear" style="display: none;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="search-results" id="phone2-modal-results"></div>
            </div>
        </div>
        
        <div class="results-section" id="results-section" style="display: none;">
            <h2 class="section-title">შედარების შედეგები</h2>
            
            <div class="comparison-result" id="comparison-result" style="display: none;">
                <div class="score-container">
                    <div class="score-card" id="score-card1">
                        <h4 id="phone1-title-score">ტელეფონი 1</h4>
                        <div class="total-score" id="phone1-score">0</div>
                        <div class="score-label">ჯამური ქულა</div>
                    </div>
                    
                    <div class="score-card" id="score-card2">
                        <h4 id="phone2-title-score">ტელეფონი 2</h4>
                        <div class="total-score" id="phone2-score">0</div>
                        <div class="score-label">ჯამური ქულა</div>
                    </div>
                </div>
                
                <div id="winner-banner" class="winner-banner" style="display: none;">
                    <i class="fas fa-trophy"></i> 
                    <span id="winner-name"></span> გამარჯვებულია <span id="winner-diff"></span> ქულის სხვაობით!
                </div>
                
                <div id="draw-banner" class="draw-banner" style="display: none;">
                    <i class="fas fa-handshake"></i> ტელეფონებმა დააგროვეს ქულების ერთნაირი რაოდენობა!
                </div>
                
                <h3 class="section-title" style="margin-top: 40px;">დეტალური ქულები</h3>
                <div class="category-scores" id="category-scores"></div>
            </div>
            
            <div class="mobile-specs" id="mobile-specs" style="display: none;">
                <h3 class="section-title">მახასიათებლები</h3>
                <div class="mobile-specs-container" id="mobile-specs-container"></div>
            </div>
            
            <div class="results-container">
                <div class="phone-card" id="phone1-card">
                    <h3 id="phone1-title">ტელეფონი 1</h3>
                    <div class="phone-image">
                        <img id="phone1-img" src="" alt="ტელეფონი 1">
                    </div>
                    <div class="phone-specs" id="phone1-specs"></div>
                </div>
                
                <div class="phone-card" id="phone2-card">
                    <h3 id="phone2-title">ტელეფონი 2</h3>
                    <div class="phone-image">
                        <img id="phone2-img" src="" alt="ტელეფონი 2">
                    </div>
                    <div class="phone-specs" id="phone2-specs"></div>
                </div>
            </div>
            
            <div class="comparison-table">
                <h3 class="section-title">მახასიათებლების შედარებითი ცხრილი</h3>
                <table id="comparison-table">
                    <thead>
                        <tr>
                            <th>მახასიათებელი</th>
                            <th id="phone1-table-title">ტელეფონი 1</th>
                            <th id="phone2-table-title">ტელეფონი 2</th>
                        </tr>
                    </thead>
                    <tbody id="comparison-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // ========================================================
        // DOM элементы и обработчики событий
        // ========================================================
        
        // Объекты для хранения данных о телефонах
        let phone1 = null;
        let phone2 = null;

        // Таймеры для задержки поиска
        let searchTimer1 = null;
        let searchTimer2 = null;

        // Элементы DOM
        const phone1Search = document.getElementById('phone1-modal-search');
        const phone2Search = document.getElementById('phone2-modal-search');
        const phone1Results = document.getElementById('phone1-modal-results');
        const phone2Results = document.getElementById('phone2-modal-results');
        const phone1Clear = document.getElementById('phone1-clear');
        const phone2Clear = document.getElementById('phone2-clear');
        const compareBtn = document.getElementById('compare-phones');
        const resultsSection = document.getElementById('results-section');

        // Модальные окна
        const modal1 = document.getElementById('phone1-modal');
        const modal2 = document.getElementById('phone2-modal');

        // Кнопки выбора телефонов
        const selectPhone1Btn = document.getElementById('select-phone1-btn');
        const selectPhone2Btn = document.getElementById('select-phone2-btn');

        // Обработчики событий
        phone1Search.addEventListener('input', () => handleSearchInput(1));
        phone2Search.addEventListener('input', () => handleSearchInput(2));
        phone1Clear.addEventListener('click', () => clearPhoneSelection(1));
        phone2Clear.addEventListener('click', () => clearPhoneSelection(2));
        compareBtn.addEventListener('click', comparePhonesHandler);
        selectPhone1Btn.addEventListener('click', () => modal1.style.display = 'block');
        selectPhone2Btn.addEventListener('click', () => modal2.style.display = 'block');

        // Закрытие модальных окон
        document.querySelectorAll('.close-modal').forEach(closeBtn => {
            closeBtn.addEventListener('click', function() {
                this.closest('.modal').style.display = 'none';
            });
        });

        // Закрытие модальных окон при клике вне области
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        });

        // Обработка ввода в поле поиска модального окна
        function handleSearchInput(phoneNumber) {
            const input = phoneNumber === 1 ? phone1Search : phone2Search;
            const resultsContainer = phoneNumber === 1 ? phone1Results : phone2Results;
            
            const query = input.value.trim();
            
            // Скрываем результаты, если запрос пустой
            if (!query) {
                resultsContainer.style.display = 'none';
                return;
            }
            
            // Показываем загрузку
            resultsContainer.innerHTML = '<div class="loader"><i class="fas fa-spinner"></i> ტელეფონების ძებნა...</div>';
            resultsContainer.style.display = 'block';
            
            // Очищаем предыдущий таймер
            if (phoneNumber === 1) clearTimeout(searchTimer1);
            else clearTimeout(searchTimer2);
            
            // Устанавливаем новый таймер для задержки запроса
            const timer = setTimeout(() => {
                searchPhones(query, phoneNumber);
            }, 300);
            
            if (phoneNumber === 1) searchTimer1 = timer;
            else searchTimer2 = timer;
        }

        // Поиск телефонов в базе данных
        async function searchPhones(query, phoneNumber) {
            const resultsContainer = phoneNumber === 1 ? phone1Results : phone2Results;
            
            try {
                const data = await searchPhonesApi(query);
                
                if (data.length === 0) {
                    resultsContainer.innerHTML = '<div class="no-results">ტელეფონები არ მოიძებნა</div>';
                    return;
                }
                
                let resultsHTML = '';
                data.forEach(phone => {
                    const imageUrl = phone.Изображение || 'https://via.placeholder.com/50x50?text=📱';
                    const year = phone['Год выпуска'] || '-';
                    
                    resultsHTML += `
                        <div class="result-item" data-id="${phone._id}" data-phone='${JSON.stringify(phone)}'>
                            <img src="${imageUrl}" alt="${phone.Бренд} ${phone.Модель}">
                            <div class="result-info">
                                <div class="result-brand">${phone.Бренд}</div>
                                <div class="result-model">${phone.Модель}</div>
                            </div>
                            <div class="result-year">${year}</div>
                        </div>
                    `;
                });
                
                resultsContainer.innerHTML = resultsHTML;
                
                // Добавляем обработчики выбора
                document.querySelectorAll(`#phone${phoneNumber}-modal-results .result-item`).forEach(item => {
                    item.addEventListener('click', () => {
                        selectPhone(item, phoneNumber);
                        if (phoneNumber === 1) modal1.style.display = 'none';
                        else modal2.style.display = 'none';
                    });
                });
            } catch (error) {
                console.error('Ошибка поиска:', error);
                resultsContainer.innerHTML = '<div class="no-results">ძებნის შეცდომა. სცადეთ მოგვიანებით.</div>';
            }
        }

        // Выбор телефона из результатов поиска
        function selectPhone(element, phoneNumber) {
            const phone = JSON.parse(element.dataset.phone);
            
            if (phoneNumber === 1) {
                phone1 = phone;
                document.getElementById('selected-phone1-name').textContent = `${phone.Бренд} ${phone.Модель}`;
                document.getElementById('selected-phone1-img').src = phone.Изображение || 'https://via.placeholder.com/50x50?text=📱';
                document.getElementById('selected-phone1').style.display = 'flex';
            } else {
                phone2 = phone;
                document.getElementById('selected-phone2-name').textContent = `${phone.Бренд} ${phone.Модель}`;
                document.getElementById('selected-phone2-img').src = phone.Изображение || 'https://via.placeholder.com/50x50?text=📱';
                document.getElementById('selected-phone2').style.display = 'flex';
            }
            
            displayPhoneDetails(phone, phoneNumber);
            
            // Активируем кнопку сравнения если выбраны оба телефона
            if (phone1 && phone2) {
                compareBtn.disabled = false;
            }
        }

        // Очистка выбранного телефона
        function clearPhoneSelection(phoneNumber) {
            if (phoneNumber === 1) {
                phone1 = null;
                document.getElementById('selected-phone1').style.display = 'none';
                document.getElementById('phone1-title').textContent = 'ტელეფონი 1';
                document.getElementById('phone1-specs').innerHTML = '';
                document.getElementById('phone1-img').src = '';
            } else {
                phone2 = null;
                document.getElementById('selected-phone2').style.display = 'none';
                document.getElementById('phone2-title').textContent = 'ტელეფონი 2';
                document.getElementById('phone2-specs').innerHTML = '';
                document.getElementById('phone2-img').src = '';
            }
            
            compareBtn.disabled = !(phone1 && phone2);
            
            // Скрываем результаты, если очищены оба телефона
            if (!phone1 && !phone2) {
                resultsSection.style.display = 'none';
            }
        }

        // Отображение деталей телефона с группировкой
        function displayPhoneDetails(phone, phoneNumber) {
            const titleElement = document.getElementById(`phone${phoneNumber}-title`);
            const imgElement = document.getElementById(`phone${phoneNumber}-img`);
            const specsElement = document.getElementById(`phone${phoneNumber}-specs`);
            
            titleElement.textContent = `${phone.Бренд} ${phone.Модель}`;
            
            // Используем изображение из базы, если есть
            imgElement.src = phone.Изображение || 'https://via.placeholder.com/220x300?text=📱';
            
            // Группировка характеристик
            const groups = [
                {
                    title: "ძირითადი მახასიათებლები",
                    specs: [
                        { name: "გამოშვების წელი", value: phone['Год выпуска'] || '-' },
                        { name: "ოპერაციული სისტემა", value: phone.ОС || '-' },
                        { name: "ოპერაციული სისტემის ვერსია", value: phone['Версия ОС'] || '-' },
                        { name: "პროცესორი (CPU)", value: phone.Процессор || '-' },
                        { name: "გრაფიკული პროცესორი (GPU)", value: phone['Графический процессор'] || '-' },
                        { name: "AnTuTu შეფასება", value: phone['Оценка AnTuTu'] || '-' },
                        { name: "Geekbench (მრავალბირთვიანი)", value: phone['Geekbench (многоядерное)'] || '-' }
                    ]
                },
                {
                    title: "ეკრანი",
                    specs: [
                        { name: "ეკრანის ზომა (დუიმი)", value: phone['Размер дисплея (дюймы)'] || '-' },
                        { name: "გაფართოება", value: phone['Разрешение дисплея'] || '-' },
                        { name: "ეკრანის ტიპი", value: phone['Тип дисплея'] || '-' },
                        { name: "განახლების სიხშირე (Hz)", value: phone['Частота обновления (Гц)'] || '-' },
                        { name: "მაქსიმალური სიკაშკაშე (ნიტი)", value: phone['Пиковая яркость (нит)'] || '-' },
                        { name: "HDR მხარდაჭერა", value: phone['Поддержка HDR'] || '-' },
                        { name: "დამცავი მინა", value: phone['Защитное стекло'] || '-' },
                        { name: "ეკრანი/კორპუსის თანაფარდობა", value: phone['Соотношение экран/корпус'] || '-' },
                        { name: "პიქსელების სიმჭიდროვე (PPI)", value: phone['Плотность пикселей (PPI)'] || '-' }
                    ]
                },
                {
                    title: "პროცესორი",
                    specs: [
                        { name: "პროცესორი (CPU)", value: phone.Процессор || '-' },
                        { name: "CPU არქიტექტურა", value: phone['Архитектура CPU'] || '-' },
                        { name: "გრაფიკული პროცესორი (GPU)", value: phone['Графический процессор'] || '-' },
                        { name: "GPU არქიტექტურა", value: phone['Архитектура GPU'] || '-' },
                        { name: "NPU", value: phone.NPU || '-' },
                        { name: "ISP", value: phone.ISP || '-' },
                        { name: "მოდემი", value: phone.Модем || '-' },
                        { name: "AnTuTu შეფასება", value: phone['Оценка AnTuTu'] || '-' },
                        { name: "Geekbench (ერთბირთვიანი)", value: phone['Geekbench (одиночное ядро)'] || '-' },
                        { name: "Geekbench (მრავალბირთვიანი)", value: phone['Geekbench (многоядерное)'] || '-' }
                    ]
                },
                {
                    title: "მეხსიერება",
                    specs: [
                        { name: "ოპერატიული მეხსიერება (GB)", value: phone['ОЗУ (ГБ)'] || '-' },
                        { name: "ოპერატიული მეხსიერების ტიპი", value: phone['Тип ОЗУ'] || '-' },
                        { name: "ოპერატიული მეხსიერების სიხშირე (MHz)", value: phone['Частота ОЗУ (МГц)'] || '-' },
                        { name: "შიდა მეხსიერება (GB)", value: phone['ПЗУ (ГБ)'] || '-' },
                        { name: "შიდა მეხსიერების ტიპი", value: phone['Тип ПЗУ'] || '-' },
                        { name: "შიდა მეხსიერების სიჩქარე", value: phone['Скорость ПЗУ'] || '-' }
                    ]
                },
                {
                    title: "გაგრილების სისტემა",
                    specs: [
                        { name: "გაგრილების სისტემა", value: phone['Система охлаждения'] || '-' },
                        { name: "გაგრილების ზედაპირი (მმ²)", value: phone['Площадь охлаждения (мм²)'] || '-' }
                    ]
                },
                {
                    title: "კამერა",
                    specs: [
                        { name: "მთავარი კამერა (MP)", value: phone['Основная камера (Мп)'] || '-' },
                        { name: "ულტრა ფართო კუთხის კამერა (MP)", value: phone['Сверхширокоугольная камера (Мп)'] || '-' },
                        { name: "ტელე ფოტო 1 (MP)", value: phone['Телефото 1 (Мп)'] || '-' },
                        { name: "ტელე ფოტო 2 (MP)", value: phone['Телефото 2 (Мп)'] || '-' },
                        { name: "წინა კამერა (MP)", value: phone['Фронтальная камера (Мп)'] || '-' },
                        { name: "სენსორის ზომა (მთავარი)", value: phone['Размер сенсора (основной)'] || '-' },
                        { name: "პიქსელის ზომა (მთავარი)", value: phone['Размер пикселя (основной)'] || '-' },
                        { name: "ზუმის შესაძლებლობები", value: phone['Возможности зума'] || '-' },
                        { name: "ვიდეო ჩაწერა", value: phone.Видеозапись || '-' },
                        { name: "ნელი მოძრაობა", value: phone['Замедленная съемка'] || '-' },
                        { name: "კამერის ფუნქციები", value: phone['Функции камеры'] || '-' }
                    ]
                },
                {
                    title: "ბატარეა",
                    specs: [
                        { name: "ტევადობა (mAh)", value: phone['Емкость батареи (mAh)'] || '-' },
                        { name: "ბატარეის ტიპი", value: phone['Тип батареи'] || '-' },
                        { name: "სწრაფი დატენვა", value: phone['Быстрая зарядка'] || '-' },
                        { name: "უსადენო დატენვა", value: phone['Беспроводная зарядка'] || '-' },
                        { name: "უკუღმა უსადენო დატენვა", value: phone['Обратная беспроводная зарядка'] || '-' },
                        { name: "დატენვის ინტერფეისი", value: phone['Интерфейс зарядки'] || '-' },
                        { name: "მუშაობის დრო (საათი)", value: phone['Время работы от батареи (ч)'] || '-' },
                        { name: "მოხმარება ლოდინის რეჟიმში", value: phone['Потребление в режиме ожидания'] || '-' },
                        { name: "მაქსიმალური სიმძლავრე", value: phone['Пиковая мощность'] || '-' }
                    ]
                },
                {
                    title: "დიზაინი",
                    specs: [
                        { name: "წონა (გრ)", value: phone['Вес (г)'] || '-' },
                        { name: "ზომები (მმ)", value: phone['Габариты (мм)'] || '-' },
                        { name: "კორპუსის მასალა", value: phone['Материал корпуса'] || '-' },
                        { name: "წყლისგან დაცვა", value: phone['Защита от воды'] || '-' },
                        { name: "მტვრისგან დაცვა", value: phone['Защита от пыли'] || '-' },
                        { name: "სერთიფიკატი", value: phone['Сертификат защиты'] || '-' },
                        { name: "ჩარჩოს მასალა", value: phone['Материал рамки'] || '-' },
                        { name: "უკანა პანელის მასალა", value: phone['Материал задней панели'] || '-' },
                        { name: "ფერები", value: phone.Цвета || '-' }
                    ]
                },
                {
                    title: "კავშირი",
                    specs: [
                        { name: "5G მხარდაჭერა", value: phone['Поддержка 5G'] || '-' },
                        { name: "5G დიაპაზონები", value: phone['Диапазоны 5G'] || '-' },
                        { name: "mmWave მხარდაჭერა", value: phone['Поддержка mmWave'] || '-' },
                        { name: "SIM სლოტები", value: phone['Слоты SIM'] || '-' },
                        { name: "SIM ბარათის ტიპი", value: phone['Тип SIM'] || '-' },
                        { name: "Wi-Fi", value: phone['Wi-Fi'] || '-' },
                        { name: "Wi-Fi მახასიათებლები", value: phone['Особенности Wi-Fi'] || '-' },
                        { name: "Bluetooth", value: phone.Bluetooth || '-' },
                        { name: "Bluetooth კოდეკები", value: phone['Кодеки Bluetooth'] || '-' },
                        { name: "NFC", value: phone.NFC || '-' },
                        { name: "IR პორტი", value: phone['ИК-порт'] || '-' },
                        { name: "USB ვერსია", value: phone['Версия USB'] || '-' },
                        { name: "GPS", value: phone.GPS || '-' },
                        { name: "სატელიტური კავშირი", value: phone['Спутниковая связь'] || '-' }
                    ]
                },
                {
                    title: "აუდიო",
                    specs: [
                        { name: "დინამიკები", value: phone.Динамики || '-' },
                        { name: "აუდიო კონფიგურაცია", value: phone['Аудионастройка'] || '-' },
                        { name: "მიკროფონები", value: phone.Микрофоны || '-' },
                        { name: "აუდიო ჯეკი", value: phone.Аудиоразъем || '-' },
                        { name: "სივრცული ხმა", value: phone['Пространственный звук'] || '-' }
                    ]
                },
                {
                    title: "უსაფრთხოება",
                    specs: [
                        { name: "თითის ანაბეჭდის სკანერი", value: phone['Сканер отпечатков'] || '-' },
                        { name: "სახით განბლოკვა", value: phone['Разблокировка по лицу'] || '-' }
                    ]
                },
                {
                    title: "სენსორები",
                    specs: [
                        { name: "აქსელერომეტრი", value: phone.Акселерометр || '-' },
                        { name: "გიროსკოპი", value: phone.Гироскоп || '-' },
                        { name: "სიახლოვის სენსორი", value: phone['Датчик приближения'] || '-' },
                        { name: "კომპასი", value: phone.Компас || '-' },
                        { name: "ბარომეტრი", value: phone.Барометр || '-' },
                        { name: "განათების სენსორი", value: phone['Датчик освещенности'] || '-' },
                        { name: "ჰოლის სენსორი", value: phone['Датчик Холла'] || '-' },
                        { name: "LiDAR", value: phone.LiDAR || '-' },
                        { name: "თერმომეტრი", value: phone.Термометр || '-' },
                        { name: "SpO2 სენსორი", value: phone['Датчик SpO2'] || '-' }
                    ]
                },
                {
                    title: "სხვა ფუნქციები",
                    specs: [
                        { name: "სტილუსის მხარდაჭერა", value: phone['Поддержка стилуса'] || '-' },
                        { name: "სტილუსის ტიპი", value: phone['Тип стилуса'] || '-' },
                        { name: "სამუშაო მაგიდის რეჟიმი", value: phone['Режим рабочего стола'] || '-' },
                        { name: "VR მხარდაჭერა", value: phone['Поддержка VR'] || '-' },
                        { name: "AI ფუნქციები", value: phone['ИИ-функции'] || '-' },
                        { name: "თამაშის ფუნქციები", value: phone['Игровые функции'] || '-' },
                        { name: "უსაფრთხოების ჩიპი", value: phone['Безопасный чип'] || '-' }
                    ]
                },
                {
                    title: "კომპლექტაცია",
                    specs: [
                        { name: "დამტენი კომპლექტში", value: phone['Зарядное устройство в комплекте'] || '-' },
                        { name: "კაბელის ტიპი", value: phone['Тип кабеля'] || '-' },
                        { name: "ადაპტერი კომპლექტში", value: phone['Адаптер в комплекте'] || '-' },
                        { name: "ყურსასმენები კომპლექტში", value: phone['Наушники в комплекте'] || '-' },
                        { name: "ქეისი კომპლექტში", value: phone['Чехол в комплекте'] || '-' }
                    ]
                },
                {
                    title: "ეკოლოგია",
                    specs: [
                        { name: "გადამუშავებული მასალები", value: phone['Переработанные материалы'] || '-' },
                        { name: "შეფუთვა", value: phone.Упаковка || '-' },
                        { name: "ეკოსერთიფიკატები", value: phone.Экосертификаты || '-' },
                        { name: "რემონტის ინდექსი", value: phone['Индекс ремонтопригодности'] || '-' },
                        { name: "ბატარეის ციკლები", value: phone['Циклы батареи'] || '-' },
                        { name: "SAR (თავი)", value: phone['SAR (голова)'] || '-' },
                        { name: "SAR (სხეული)", value: phone['SAR (тело)'] || '-' }
                    ]
                },
                {
                    title: "ფასი",
                    specs: [
                        { name: "საწყისი ფასი (რუბ)", value: phone['Стартовая цена (руб)'] ? 
                            `${parseInt(phone['Стартовая цена (руб)']).toLocaleString('ru-RU')} რუბ.` : '-' },
                        { name: "მიმდინარე ფასი (რუბ)", value: phone['Текущая цена (руб)'] ? 
                            `${parseInt(phone['Текущая цена (руб)']).toLocaleString('ru-RU')} რუბ.` : '-' },
                        { name: "ხელმისაწვდომობა", value: phone.Доступность || '-' },
                        { name: "გარანტია (თვე)", value: phone['Гарантия (мес)'] || '-' }
                    ]
                }
            ];
            
            // Генерация HTML с группами
            let specsHTML = '';
            
            groups.forEach(group => {
                // Проверяем, есть ли хотя бы одно значение в группе
                const hasValues = group.specs.some(spec => spec.value && spec.value !== '-');
                
                if (hasValues) {
                    specsHTML += `<div class="spec-group">`;
                    specsHTML += `<h4 class="group-title">${group.title}</h4>`;
                    
                    group.specs.forEach(spec => {
                        if (spec.value && spec.value !== '-') {
                            specsHTML += `
                                <div class="spec-item">
                                    <span class="spec-title">${spec.name}</span>
                                    <span class="spec-value">${spec.value}</span>
                                </div>
                            `;
                        }
                    });
                    
                    specsHTML += `</div>`;
                }
            });
            
            specsElement.innerHTML = specsHTML;
        }

        // Функция для отображения спецификаций в мобильном виде
        function displayMobileSpecs() {
            const container = document.getElementById('mobile-specs-container');
            container.innerHTML = '';
            
            // Показываем контейнер
            document.getElementById('mobile-specs').style.display = 'block';
            
            // Группы характеристик
            const groups = [
                {
                    title: "ძირითადი მახასიათებლები",
                    specs: [
                        { name: "გამოშვების წელი", key: 'Год выпуска' },
                        { name: "ოპერაციული სისტემა", key: 'ОС' },
                        { name: "ოპერაციული სისტემის ვერსია", key: 'Версия ОС' },
                        { name: "პროცესორი (CPU)", key: 'Процессор' },
                        { name: "გრაფიკული პროცესორი (GPU)", key: 'Графический процессор' },
                        { name: "AnTuTu შეფასება", key: 'Оценка AnTuTu' },
                        { name: "Geekbench (მრავალბირთვიანი)", key: 'Geekbench (многоядерное)' }
                    ]
                },
                {
                    title: "ეკრანი",
                    specs: [
                        { name: "ეკრანის ზომა (დუიმი)", key: 'Размер дисплея (дюймы)' },
                        { name: "გაფართოება", key: 'Разрешение дисплея' },
                        { name: "ეკრანის ტიპი", key: 'Тип дисплея' },
                        { name: "განახლების სიხშირე (Hz)", key: 'Частота обновления (Гц)' },
                        { name: "მაქსიმალური სიკაშკაშე (ნიტი)", key: 'Пиковая яркость (нит)' },
                        { name: "HDR მხარდაჭერა", key: 'Поддержка HDR' },
                        { name: "დამცავი მინა", key: 'Защитное стекло' },
                        { name: "ეკრანი/კორპუსის თანაფარდობა", key: 'Соотношение экран/корпус' },
                        { name: "პიქსელების სიმჭიდროვე (PPI)", key: 'Плотность пикселей (PPI)' }
                    ]
                },
                {
                    title: "პროცესორი",
                    specs: [
                        { name: "პროცესორი (CPU)", key: 'Процессор' },
                        { name: "CPU არქიტექტურა", key: 'Архитектура CPU' },
                        { name: "გრაფიკული პროცესორი (GPU)", key: 'Графический процессор' },
                        { name: "GPU არქიტექტურა", key: 'Архитектура GPU' },
                        { name: "NPU", key: 'NPU' },
                        { name: "ISP", key: 'ISP' },
                        { name: "მოდემი", key: 'Модем' },
                        { name: "AnTuTu შეფასება", key: 'Оценка AnTuTu' },
                        { name: "Geekbench (ერთბირთვიანი)", key: 'Geekbench (одиночное ядро)' },
                        { name: "Geekbench (მრავალბირთვიანი)", key: 'Geekbench (многоядерное)' }
                    ]
                },
                {
                    title: "მეხსიერება",
                    specs: [
                        { name: "ოპერატიული მეხსიერება (GB)", key: 'ОЗУ (ГБ)' },
                        { name: "ოპერატიული მეხსიერების ტიპი", key: 'Тип ОЗУ' },
                        { name: "ოპერატიული მეხსიერების სიხშირე (MHz)", key: 'Частота ОЗУ (МГц)' },
                        { name: "შიდა მეხსიერება (GB)", key: 'ПЗУ (ГБ)' },
                        { name: "შიდა მეხსიერების ტიპი", key: 'Тип ПЗУ' },
                        { name: "შიდა მეხსიერების სიჩქარე", key: 'Скорость ПЗУ' }
                    ]
                },
                {
                    title: "გაგრილების სისტემა",
                    specs: [
                        { name: "გაგრილების სისტემა", key: 'Система охлаждения' },
                        { name: "გაგრილების ზედაპირი (მმ²)", key: 'Площадь охлаждения (мм²)' }
                    ]
                },
                {
                    title: "კამერა",
                    specs: [
                        { name: "მთავარი კამერა (MP)", key: 'Основная камера (Мп)' },
                        { name: "ულტრა ფართო კუთხის კამერა (MP)", key: 'Сверхширокоугольная камера (Мп)' },
                        { name: "ტელე ფოტო 1 (MP)", key: 'Телефото 1 (Мп)' },
                        { name: "ტელე ფოტო 2 (MP)", key: 'Телефото 2 (Мп)' },
                        { name: "წინა კამერა (MP)", key: 'Фронтальная камера (Мп)' },
                        { name: "სენსორის ზომა (მთავარი)", key: 'Размер сенсора (основной)' },
                        { name: "პიქსელის ზომა (მთავარი)", key: 'Размер пикселя (основной)' },
                        { name: "ზუმის შესაძლებლობები", key: 'Возможности зума' },
                        { name: "ვიდეო ჩაწერა", key: 'Видеозапись' },
                        { name: "ნელი მოძრაობა", key: 'Замедленная съемка' },
                        { name: "კამერის ფუნქციები", key: 'Функции камеры' }
                    ]
                },
                {
                    title: "ბატარეა",
                    specs: [
                        { name: "ტევადობა (mAh)", key: 'Емкость батареи (mAh)' },
                        { name: "ბატარეის ტიპი", key: 'Тип батареи' },
                        { name: "სწრაფი დატენვა", key: 'Быстрая зарядка' },
                        { name: "უსადენო დატენვა", key: 'Беспроводная зарядка' },
                        { name: "უკუღმა უსადენო დატენვა", key: 'Обратная беспроводная зарядка' },
                        { name: "დატენვის ინტერფეისი", key: 'Интерфейс зарядки' },
                        { name: "მუშაობის დრო (საათი)", key: 'Время работы от батареи (ч)' },
                        { name: "მოხმარება ლოდინის რეჟიმში", key: 'Потребление в режиме ожидания' },
                        { name: "მაქსიმალური სიმძლავრე", key: 'Пиковая мощность' }
                    ]
                },
                {
                    title: "დიზაინი",
                    specs: [
                        { name: "წონა (გრ)", key: 'Вес (г)' },
                        { name: "ზომები (მმ)", key: 'Габариты (мм)' },
                        { name: "კორპუსის მასალა", key: 'Материал корпуса' },
                        { name: "წყლისგან დაცვა", key: 'Защита от воды' },
                        { name: "მტვრისგან დაცვა", key: 'Защита от пыли' },
                        { name: "სერთიფიკატი", key: 'Сертификат защиты' },
                        { name: "ჩარჩოს მასალა", key: 'Материал рамки' },
                        { name: "უკანა პანელის მასალა", key: 'Материал задней панели' },
                        { name: "ფერები", key: 'Цвета' }
                    ]
                },
                {
                    title: "კავშირი",
                    specs: [
                        { name: "5G მხარდაჭერა", key: 'Поддержка 5G' },
                        { name: "5G დიაპაზონები", key: 'Диапазоны 5G' },
                        { name: "mmWave მხარდაჭერა", key: 'Поддержка mmWave' },
                        { name: "SIM სლოტები", key: 'Слоты SIM' },
                        { name: "SIM ბარათის ტიპი", key: 'Тип SIM' },
                        { name: "Wi-Fi", key: 'Wi-Fi' },
                        { name: "Wi-Fi მახასიათებლები", key: 'Особенности Wi-Fi' },
                        { name: "Bluetooth", key: 'Bluetooth' },
                        { name: "Bluetooth კოდეკები", key: 'Кодеки Bluetooth' },
                        { name: "NFC", key: 'NFC' },
                        { name: "IR პორტი", key: 'ИК-порт' },
                        { name: "USB ვერსია", key: 'Версия USB' },
                        { name: "GPS", key: 'GPS' },
                        { name: "სატელიტური კავშირი", key: 'Спутниковая связь' }
                    ]
                },
                {
                    title: "აუდიო",
                    specs: [
                        { name: "დინამიკები", key: 'Динамики' },
                        { name: "აუდიო კონფიგურაცია", key: 'Аудионастройка' },
                        { name: "მიკროფონები", key: 'Микрофоны' },
                        { name: "აუდიო ჯეკი", key: 'Аудиоразъем' },
                        { name: "სივრცული ხმა", key: 'Пространственный звук' }
                    ]
                },
                {
                    title: "უსაფრთხოება",
                    specs: [
                        { name: "თითის ანაბეჭდის სკანერი", key: 'Сканер отпечатков' },
                        { name: "სახით განბლოკვა", key: 'Разблокировка по лицу' }
                    ]
                },
                {
                    title: "სენსორები",
                    specs: [
                        { name: "აქსელერომეტრი", key: 'Акселерометр' },
                        { name: "გიროსკოპი", key: 'Гироскоп' },
                        { name: "სიახლოვის სენსორი", key: 'Датчик приближения' },
                        { name: "კომპასი", key: 'Компас' },
                        { name: "ბარომეტრი", key: 'Барометр' },
                        { name: "განათების სენსორი", key: 'Датчик освещенности' },
                        { name: "ჰოლის სენსორი", key: 'Датчик Холла' },
                        { name: "LiDAR", key: 'LiDAR' },
                        { name: "თერმომეტრი", key: 'Термометр' },
                        { name: "SpO2 სენსორი", key: 'Датчик SpO2' }
                    ]
                },
                {
                    title: "სხვა ფუნქციები",
                    specs: [
                        { name: "სტილუსის მხარდაჭერა", key: 'Поддержка стилуса' },
                        { name: "სტილუსის ტიპი", key: 'Тип стилуса' },
                        { name: "სამუშაო მაგიდის რეჟიმი", key: 'Режим рабочего стола' },
                        { name: "VR მხარდაჭერა", key: 'Поддержка VR' },
                        { name: "AI ფუნქციები", key: 'ИИ-функции' },
                        { name: "თამაშის ფუნქციები", key: 'Игровые функции' },
                        { name: "უსაფრთხოების ჩიპი", key: 'Безопасный чип' }
                    ]
                },
                {
                    title: "კომპლექტაცია",
                    specs: [
                        { name: "დამტენი კომპლექტში", key: 'Зарядное устройство в комплекте' },
                        { name: "კაბელის ტიპი", key: 'Тип кабеля' },
                        { name: "ადაპტერი კომპლექტში", key: 'Адаптер в комплекте' },
                        { name: "ყურსასმენები კომპლექტში", key: 'Наушники в комплекте' },
                        { name: "ქეისი კომპლექტში", key: 'Чехол в комплекте' }
                    ]
                },
                {
                    title: "ეკოლოგია",
                    specs: [
                        { name: "გადამუშავებული მასალები", key: 'Переработанные материалы' },
                        { name: "შეფუთვა", key: 'Упаковка' },
                        { name: "ეკოსერთიფიკატები", key: 'Экосертификаты' },
                        { name: "რემონტის ინდექსი", key: 'Индекс ремонтопригодности' },
                        { name: "ბატარეის ციკლები", key: 'Циклы батареи' },
                        { name: "SAR (თავი)", key: 'SAR (голова)' },
                        { name: "SAR (სხეული)", key: 'SAR (тело)' }
                    ]
                },
                {
                    title: "ფასი",
                    specs: [
                        { name: "საწყისი ფასი (რუბ)", key: 'Стартовая цена (руб)' },
                        { name: "მიმდინარე ფასი (რუბ)", key: 'Текущая цена (руб)' },
                        { name: "ხელმისაწვდომობა", key: 'Доступность' },
                        { name: "გარანტია (თვე)", key: 'Гарантия (мес)' }
                    ]
                }
            ];
            
            let specsHTML = '';
            
            groups.forEach(group => {
                // Проверяем, есть ли хотя бы одно значение в группе
                const hasValues = group.specs.some(spec => 
                    (phone1[spec.key] && phone1[spec.key] !== '-') || 
                    (phone2[spec.key] && phone2[spec.key] !== '-')
                );
                
                if (hasValues) {
                    specsHTML += `<div class="spec-group-mobile">`;
                    specsHTML += `<h4 class="group-title-mobile">${group.title}</h4>`;
                    
                    group.specs.forEach(spec => {
                        let value1 = phone1[spec.key] || '-';
                        let value2 = phone2[spec.key] || '-';
                        
                        // Форматируем цену
                        if ((spec.key === 'Стартовая цена (руб)' || spec.key === 'Текущая цена (руб)') && value1 !== '-') {
                            value1 = `${parseInt(value1).toLocaleString('ru-RU')} რუბ.`;
                        }
                        if ((spec.key === 'Стартовая цена (руб)' || spec.key === 'Текущая цена (руб)') && value2 !== '-') {
                            value2 = `${parseInt(value2).toLocaleString('ru-RU')} რუბ.`;
                        }
                        
                        if (value1 !== '-' || value2 !== '-') {
                            specsHTML += `
                                <div class="spec-item-mobile">
                                    <div class="spec-name-mobile">${spec.name}</div>
                                    <div class="spec-value-container">
                                        <div class="spec-phone">
                                            <div class="spec-phone-title">${phone1.Бренд}</div>
                                            <div class="spec-value-mobile">${value1}</div>
                                        </div>
                                        <div class="spec-phone">
                                            <div class="spec-phone-title">${phone2.Бренд}</div>
                                            <div class="spec-value-mobile">${value2}</div>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }
                    });
                    
                    specsHTML += `</div>`;
                }
            });
            
            container.innerHTML = specsHTML;
        }

        // Сравнение характеристик телефонов
        function comparePhonesHandler() {
            if (!phone1 || !phone2) {
                alert('აირჩიეთ ორივე ტელეფონი შესადარებლად');
                return;
            }
            
            // Показываем секцию с результатами
            resultsSection.style.display = 'block';
            
            // Обновляем заголовки
            document.getElementById('phone1-title').textContent = 
                `${phone1.Бренд} ${phone1.Модель}`;
                
            document.getElementById('phone2-title').textContent = 
                `${phone2.Бренд} ${phone2.Модель}`;
                
            document.getElementById('phone1-title-score').textContent = 
                `${phone1.Бренд} ${phone1.Модель}`;
                
            document.getElementById('phone2-title-score').textContent = 
                `${phone2.Бренд} ${phone2.Модель}`;
            
            // Сравниваем телефоны
            const comparisonResult = comparePhones(phone1, phone2);
            
            // Отображаем результаты балльной системы
            displayComparisonResult(comparisonResult);
            
            // Отображаем таблицу характеристик
            displayComparisonTable(comparisonResult);
            
            // Для мобильных: показываем спецификации в новом формате
            if (window.innerWidth <= 768) {
                displayMobileSpecs();
            }
            
            // Прокрутка к результатам
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Отображение таблицы характеристик
        function displayComparisonTable(result) {
            // Обновляем заголовки таблицы
            document.getElementById('phone1-table-title').textContent = 
                `${phone1.Бренд} ${phone1.Модель}`;
                
            document.getElementById('phone2-table-title').textContent = 
                `${phone2.Бренд} ${phone2.Модель}`;
            
            // Список характеристик для сравнения
            const specsToCompare = [
                'Год выпуска', 'ОС', 'Версия ОС', 
                'Размер дисплея (дюймы)', 'Разрешение дисплея', 'Тип дисплея',
                'Частота обновления (Гц)', 'Пиковая яркость (нит)', 'Поддержка HDR',
                'Защитное стекло', 'Соотношение экран/корпус', 'Плотность пикселей (PPI)',
                'Процессор', 'Архитектура CPU', 'Графический процессор', 'Архитектура GPU',
                'NPU', 'ISP', 'Модем', 'Оценка AnTuTu', 'Geekbench (одиночное ядро)', 
                'Geekbench (многоядерное)', 'ОЗУ (ГБ)', 'Тип ОЗУ', 'Частота ОЗУ (МГц)',
                'ПЗУ (ГБ)', 'Тип ПЗУ', 'Скорость ПЗУ', 'Система охлаждения', 'Площадь охлаждения (мм²)',
                'Основная камера (Мп)', 'Сверхширокоугольная камера (Мп)', 'Телефото 1 (Мп)',
                'Телефото 2 (Мп)', 'Фронтальная камера (Мп)', 'Размер сенсора (основной)',
                'Размер пикселя (основной)', 'Возможности зума', 'Видеозапись', 'Замедленная съемка',
                'Функции камеры', 'Емкость батареи (mAh)', 'Тип батареи', 'Быстрая зарядка',
                'Беспроводная зарядка', 'Обратная беспроводная зарядка', 'Интерфейс зарядки',
                'Время работы от батареи (ч)', 'Потребление в режиме ожидания', 'Пиковая мощность',
                'Вес (г)', 'Габариты (мм)', 'Материал корпуса', 'Защита от воды', 'Защита от пыли',
                'Сертификат защиты', 'Материал рамки', 'Материал задней панели', 'Цвета',
                'Поддержка 5G', 'Диапазоны 5G', 'Поддержка mmWave', 'Слоты SIM', 'Тип SIM',
                'Wi-Fi', 'Особенности Wi-Fi', 'Bluetooth', 'Кодеки Bluetooth', 'NFC', 'ИК-порт',
                'Версия USB', 'GPS', 'Спутниковая связь', 'Динамики', 'Аудионастройка', 'Микрофоны',
                'Аудиоразъем', 'Пространственный звук', 'Сканер отпечатков', 'Разблокировка по лицу',
                'Акселерометр', 'Гироскоп', 'Датчик приближения', 'Компас', 'Барометр',
                'Датчик освещенности', 'Датчик Холла', 'LiDAR', 'Термометр', 'Датчик SpO2',
                'Поддержка стилуса', 'Тип стилуса', 'Режим рабочего стола', 'Поддержка VR',
                'ИИ-функции', 'Игровые функции', 'Безопасный чип', 'Зарядное устройство в комплекте',
                'Тип кабеля', 'Адаптер в комплекте', 'Наушники в комплекте', 'Чехол в комплекте',
                'Переработанные материалы', 'Упаковка', 'Экосертификаты', 'Индекс ремонтопригодности',
                'Циклы батареи', 'SAR (голова)', 'SAR (тело)', 'Стартовая цена (руб)', 'Текущая цена (руб)',
                'Доступность', 'Гарантия (мес)'
            ];
            
            // Строим таблицу сравнения
            const comparisonBody = document.getElementById('comparison-body');
            comparisonBody.innerHTML = '';
            
            specsToCompare.forEach(spec => {
                let value1 = phone1[spec] || '-';
                let value2 = phone2[spec] || '-';
                
                // Форматируем цену
                if ((spec === 'Стартовая цена (руб)' || spec === 'Текущая цена (руб)') && value1 !== '-') {
                    value1 = `${parseInt(value1).toLocaleString('ru-RU')} რუბ.`;
                }
                if ((spec === 'Стартовая цена (руб)' || spec === 'Текущая цена (руб)') && value2 !== '-') {
                    value2 = `${parseInt(value2).toLocaleString('ru-RU')} რუბ.`;
                }
                
                const row = document.createElement('tr');
                
                // Выделяем лучшие значения
                let highlight1 = '';
                let highlight2 = '';
                
                // Используем логику сравнения
                const comparison = compareFeature(spec, value1, value2);
                if (comparison === 1) highlight1 = 'highlight';
                else if (comparison === 2) highlight2 = 'highlight';
                
                row.innerHTML = `
                    <td><strong>${spec}</strong></td>
                    <td class="${highlight1}">${value1}</td>
                    <td class="${highlight2}">${value2}</td>
                `;
                
                comparisonBody.appendChild(row);
            });
        }

        // Функция для сравнения характеристик
        function compareFeature(spec, value1, value2) {
            // Если значения равны, нет победителя
            if (value1 === value2) return 0;
            
            // Для числовых характеристик
            if (!isNaN(parseFloat(value1))) {
                return parseFloat(value1) > parseFloat(value2) ? 1 : 2;
            }
            
            // Для текстовых характеристик
            return value1 > value2 ? 1 : 2;
        }

        // Функция для отображения результатов сравнения
        function displayComparisonResult(result) {
            const resultSection = document.getElementById('comparison-result');
            resultSection.style.display = 'block';
            
            // Отображаем общие баллы
            document.getElementById('phone1-score').textContent = 
                result.phone1.score.total;
                
            document.getElementById('phone2-score').textContent = 
                result.phone2.score.total;
            
            // Добавляем классы победителя/проигравшего
            const scoreCard1 = document.getElementById('score-card1');
            const scoreCard2 = document.getElementById('score-card2');
            
            // Удаляем предыдущие классы
            scoreCard1.classList.remove('winner', 'loser');
            scoreCard2.classList.remove('winner', 'loser');
            
            if (result.winner) {
                if (result.winner.phone === phone1) {
                    scoreCard1.classList.add('winner');
                    scoreCard2.classList.add('loser');
                    
                    document.getElementById('winner-name').textContent = 
                        `${phone1.Бренд} ${phone1.Модель}`;
                    document.getElementById('winner-diff').textContent = 
                        result.winner.difference;
                        
                    document.getElementById('winner-banner').style.display = 'block';
                    document.getElementById('draw-banner').style.display = 'none';
                } else {
                    scoreCard1.classList.add('loser');
                    scoreCard2.classList.add('winner');
                    
                    document.getElementById('winner-name').textContent = 
                        `${phone2.Бренд} ${phone2.Модель}`;
                    document.getElementById('winner-diff').textContent = 
                        result.winner.difference;
                        
                    document.getElementById('winner-banner').style.display = 'block';
                    document.getElementById('draw-banner').style.display = 'none';
                }
            } else {
                scoreCard1.classList.remove('winner', 'loser');
                scoreCard2.classList.remove('winner', 'loser');
                
                document.getElementById('winner-banner').style.display = 'none';
                document.getElementById('draw-banner').style.display = 'block';
            }
            
            // Отображаем детализированные баллы
            const categories = {
                'პროდუქტიულობა': 'performance',
                'კამერა': 'camera',
                'ბატარეა': 'battery',
                'ეკრანი': 'display',
                'კავშირი': 'connectivity',
                'ფუნქციები': 'features'
            };
            
            let categoriesHTML = '';
            
            for (const [name, key] of Object.entries(categories)) {
                const score1 = result.phone1.score.categories[key];
                const score2 = result.phone2.score.categories[key];
                
                // Рассчитываем процент для отображения
                const maxScore = Math.max(score1, score2, 1);
                const percent1 = (score1 / maxScore) * 100;
                const percent2 = (score2 / maxScore) * 100;
                
                // Определяем цвет для первого телефона
                let color1 = '#3498db'; // Синий
                if (score1 > score2) color1 = '#27ae60'; // Зеленый
                else if (score1 < score2) color1 = '#e74c3c'; // Красный
                
                // Определяем цвет для второго телефона
                let color2 = '#3498db'; // Синий
                if (score2 > score1) color2 = '#27ae60'; // Зеленый
                else if (score2 < score1) color2 = '#e74c3c'; // Красный
                
                categoriesHTML += `
                    <div class="category">
                        <div class="category-title">${name}</div>
                        <div class="phone-score">
                            <span>${phone1.Бренд}</span>
                            <span>${score1.toFixed(1)}</span>
                        </div>
                        <div class="category-bar">
                            <div class="category-fill" 
                                 style="width: ${percent1}%; background: ${color1};"></div>
                        </div>
                        
                        <div class="phone-score">
                            <span>${phone2.Бренд}</span>
                            <span>${score2.toFixed(1)}</span>
                        </div>
                        <div class="category-bar">
                            <div class="category-fill" 
                                 style="width: ${percent2}%; background: ${color2};"></div>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('category-scores').innerHTML = categoriesHTML;
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', () => {
            // Обработчик клика вне области поиска
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.search-input-container')) {
                    phone1Results.style.display = 'none';
                    phone2Results.style.display = 'none';
                }
            });
        });
    </script>
    <script src="static/js/compare.js"></script>
</body>
    </html>
