<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ</title>
    <style>
        .registration-container {
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 1rem;
        }
        .birth-date-group {
            display: flex;
            gap: 10px;
        }
        .birth-date-group select,
        .birth-date-group input {
            flex: 1;
        }
        .password-requirements {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }
        .btn-primary {
            background-color: #0d6efd;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
        }
        .error-message {
            color: #dc3545;
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }
        .password-container {
            position: relative;
        }
        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="registration-container">
        <h2>áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ</h2>
        <form id="registration-form">
            <div class="form-group">
                <label class="form-label" for="first_name">áƒ¡áƒáƒ®áƒ”áƒšáƒ˜ (áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜ áƒáƒ¡áƒáƒ”áƒ‘áƒ˜)</label>
                <input type="text" class="form-control" id="first_name" name="first_name" required>
                <div class="error-message" id="first_name_error"></div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="last_name">áƒ’áƒ•áƒáƒ áƒ˜ (áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜ áƒáƒ¡áƒáƒ”áƒ‘áƒ˜)</label>
                <input type="text" class="form-control" id="last_name" name="last_name" required>
                <div class="error-message" id="last_name_error"></div>
            </div>
            
            <div class="form-group">
                <label class="form-label">áƒ“áƒáƒ‘áƒáƒ“áƒ”áƒ‘áƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜</label>
                <div class="birth-date-group">
                    <select class="form-control" id="birth_day" name="birth_day" required>
                        <option value="">áƒ“áƒ¦áƒ”</option>
                        {% for day in range(1, 32) %}
                        <option value="{{ day }}">{{ day }}</option>
                        {% endfor %}
                    </select>
                    
                    <select class="form-control" id="birth_month" name="birth_month" required>
                        <option value="">áƒ—áƒ•áƒ”</option>
                        <option value="1">áƒ˜áƒáƒœáƒ•áƒáƒ áƒ˜</option>
                        <option value="2">áƒ—áƒ”áƒ‘áƒ”áƒ áƒ•áƒáƒšáƒ˜</option>
                        <option value="3">áƒ›áƒáƒ áƒ¢áƒ˜</option>
                        <option value="4">áƒáƒáƒ áƒ˜áƒšáƒ˜</option>
                        <option value="5">áƒ›áƒáƒ˜áƒ¡áƒ˜</option>
                        <option value="6">áƒ˜áƒ•áƒœáƒ˜áƒ¡áƒ˜</option>
                        <option value="7">áƒ˜áƒ•áƒšáƒ˜áƒ¡áƒ˜</option>
                        <option value="8">áƒáƒ’áƒ•áƒ˜áƒ¡áƒ¢áƒ</option>
                        <option value="9">áƒ¡áƒ”áƒ¥áƒ¢áƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜</option>
                        <option value="10">áƒáƒ¥áƒ¢áƒáƒ›áƒ‘áƒ”áƒ áƒ˜</option>
                        <option value="11">áƒœáƒáƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜</option>
                        <option value="12">áƒ“áƒ”áƒ™áƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜</option>
                    </select>
                    
                    <select class="form-control" id="birth_year" name="birth_year" required>
                        <option value="">áƒ¬áƒ”áƒšáƒ˜</option>
                        {% for year in range(current_year, 1899, -1) %}
                        <option value="{{ year }}">{{ year }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="error-message" id="birth_date_error"></div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="phone">áƒ¢áƒ”áƒšáƒ”áƒ¤áƒáƒœáƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜ (áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ˜: +995XXXXXXXXX)</label>
                <input type="tel" class="form-control" id="phone" name="phone" placeholder="+995XXXXXXXXX" required>
                <div class="error-message" id="phone_error"></div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="email">áƒ”áƒš. áƒ¤áƒáƒ¡áƒ¢áƒ</label>
                <input type="email" class="form-control" id="email" name="email" required>
                <div class="error-message" id="email_error"></div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="username">áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜</label>
                <input type="text" class="form-control" id="username" name="username" required>
                <div class="error-message" id="username_error"></div>
            </div>
            
            <div class="form-group password-container">
                <label class="form-label" for="password">áƒáƒáƒ áƒáƒšáƒ˜</label>
                <input type="password" class="form-control" id="password" name="password" required>
                <span class="toggle-password" onclick="togglePassword('password')">ğŸ‘ï¸</span>
                <div class="password-requirements">
                    áƒáƒáƒ áƒáƒšáƒ˜ áƒ£áƒœáƒ“áƒ áƒ¨áƒ”áƒ˜áƒªáƒáƒ•áƒ“áƒ”áƒ¡:
                    <ul>
                        <li>áƒ›áƒ˜áƒœáƒ˜áƒ›áƒ£áƒ› 12 áƒ¡áƒ˜áƒ›áƒ‘áƒáƒšáƒáƒ¡</li>
                        <li>áƒ”áƒ áƒ— áƒ“áƒ˜áƒ“ áƒáƒ¡áƒáƒ¡ (A-Z)</li>
                        <li>áƒ”áƒ áƒ— áƒáƒáƒ¢áƒáƒ áƒ áƒáƒ¡áƒáƒ¡ (a-z)</li>
                        <li>áƒ”áƒ áƒ— áƒªáƒ˜áƒ¤áƒ áƒ¡ (0-9)</li>
                        <li>áƒ”áƒ áƒ— áƒ¡áƒáƒ”áƒªáƒ˜áƒáƒšáƒ£áƒ  áƒ¡áƒ˜áƒ›áƒ‘áƒáƒšáƒáƒ¡ (@$!%*?&)</li>
                    </ul>
                </div>
                <div class="error-message" id="password_error"></div>
            </div>
            
            <div class="form-group password-container">
                <label class="form-label" for="confirm_password">áƒ’áƒáƒ˜áƒ›áƒ”áƒáƒ áƒ”áƒ— áƒáƒáƒ áƒáƒšáƒ˜</label>
                <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                <span class="toggle-password" onclick="togglePassword('confirm_password')">ğŸ‘ï¸</span>
                <div class="error-message" id="confirm_password_error"></div>
            </div>
            
            <button type="submit" class="btn-primary">áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ</button>
        </form>
    </div>

    <script>
        function togglePassword(fieldId) {
            const passwordField = document.getElementById(fieldId);
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
            } else {
                passwordField.type = 'password';
            }
        }

        document.getElementById('registration-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Ğ¡Ğ±Ñ€Ğ¾Ñ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');
            
            const response = await fetch('/register', {
                method: 'POST',
                body: new FormData(e.target)
            });
            
            const result = await response.json();
            
            if (response.status === 201) {
                alert(result.message);
                window.location.href = '/';
            } else if (response.status === 400) {
                // ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
                if (result.errors) {
                    result.errors.forEach(error => {
                        // ĞĞ±Ñ‰Ğ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°
                        if (error.includes('Ğ”Ğ°Ñ‚Ğ°') || error.includes('áƒ—áƒáƒ áƒ˜áƒ¦')) {
                            document.getElementById('birth_date_error').textContent = error;
                        } 
                        // ĞŸĞ¾Ğ»ĞµĞ²Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
                        else if (error.includes('Ğ˜Ğ¼Ñ') || error.includes('áƒ¡áƒáƒ®áƒ”áƒšáƒ˜')) {
                            document.getElementById('first_name_error').textContent = error;
                        } 
                        else if (error.includes('Ğ¤Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ') || error.includes('áƒ’áƒ•áƒáƒ áƒ˜')) {
                            document.getElementById('last_name_error').textContent = error;
                        } 
                        else if (error.includes('Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½') || error.includes('áƒ¢áƒ”áƒšáƒ”áƒ¤áƒáƒœ')) {
                            document.getElementById('phone_error').textContent = error;
                        } 
                        else if (error.includes('email') || error.includes('áƒ¤áƒáƒ¡áƒ¢áƒ')) {
                            document.getElementById('email_error').textContent = error;
                        } 
                        else if (error.includes('ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ') || error.includes('áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜')) {
                            document.getElementById('username_error').textContent = error;
                        } 
                        else if (error.includes('ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ') || error.includes('áƒáƒáƒ áƒáƒšáƒ˜')) {
                            document.getElementById('password_error').textContent = error;
                        } 
                        else if (error.includes('ĞŸĞ°Ñ€Ğ¾Ğ»Ğ¸') || error.includes('áƒáƒáƒ áƒáƒšáƒ”áƒ‘áƒ˜')) {
                            document.getElementById('confirm_password_error').textContent = error;
                        }
                        else {
                            // ĞĞ±Ñ‰Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
                            alert(error);
                        }
                    });
                }
            } else {
                alert('áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ áƒ•áƒ”áƒ  áƒ›áƒáƒ®áƒ”áƒ áƒ®áƒ“áƒ. áƒ’áƒ—áƒ®áƒáƒ•áƒ— áƒ¡áƒªáƒáƒ“áƒáƒ— áƒ—áƒáƒ•áƒ˜áƒ“áƒáƒœ.');
            }
        });
    </script>
</body>
</html>
